{% extends 'base.html.twig' %}

{% block body %}
    <br><br><br>
    <div class="left-align">
    <div id="modal1" class="modal">
        {{ render(controller("AppBundle:Groupe:newModal")) }}
    </div>
    </div>
    <div class="row center">
        <div class="col s12 m4 l2">
            <a class="waves-effect waves-light btn modal-trigger" href="#modal1" style="margin-left: 5px; ">Nouveau groupe</a>
        </div>
        <div class="col s12 m4 l8">
            <div id="desc" class="container">
                <h5 class="light">Poster un plat</h5>
                <br><br>
                {{ form_start(form) }}
                {{ form_widget(form) }}
                <br><br><br>
                <div class=" waves-effect waves-light btn light">
                    <input class="submit" type="submit" value="Poster"/>
                </div>
                {{ form_end(form) }}
            </div>
        </div>
        <div class="col s12 m4 l2"></div>
    </div>
    <ul class="center">
        <li>
            <a class="ret" href="{{ path('plat_index') }}">Retour</a>
        </li>
    </ul>
<br><br>

    {% block javascripts %}
        {{ parent() }}
        <script>
            $(document).ready(function () {
                /*$( "form" ).submit(function( event ) {
                    swal("Good job!", "Vous venez d'ajouter un plat!", "success");
                });*/
                $('#add_step_new_plat_plat_categorie').select2({
                    width: '100%'
                });
                $('#add_step_new_plat_plat_groupe').select2({
                    width: '100%'
                });
            //    $('#add_step_new_reservation_reservation_date_time_hour').select2({
            //        width: '100%'
            //    });
            //    $('#add_step_new_reservation_reservation_date_time_minute').select2({
            //        width: '100%'
            //    });
                $('#add_step_new_reservation_reservation_date').pickatime({
                    default: 'now', // Set default time: 'now', '1:30AM', '16:30'
                    fromnow: 0,       // set default time to * milliseconds from now (using with default = 'now')
                    twelvehour: false, // Use AM/PM or 24-hour format
                    donetext: 'OK', // text for done-button
                    cleartext: 'Clear', // text for clear-button
                    canceltext: 'Cancel', // Text for cancel-button
                    autoclose: false, // automatic close timepicker
                    ampmclickable: true, // make AM PM clickable
                    aftershow: function(){} //Function for after opening timepicker
                });
                $('.modal').modal();

            });
        </script>


        <script type="text/javascript">
            var placeSearch, autocomplete;
            var componentResolver = {
                street_number: 'add_step_new_reservation_reservation_num',
                route: 'add_step_new_reservation_reservation_adresse',
                locality: 'add_step_new_reservation_reservation_ville',
                postal_code: 'add_step_new_reservation_reservation_cp'
            };
            var componentForm = {
                add_step_new_reservation_reservation_num: 'short_name',
                add_step_new_reservation_reservation_adresse: 'long_name',
                add_step_new_reservation_reservation_ville: 'long_name',
                add_step_new_reservation_reservation_cp: 'short_name'
            };



            function initAutocomplete() {
                // Create the autocomplete object, restricting the search to geographical
                // location types.
                autocomplete = new google.maps.places.Autocomplete((document.getElementById('add_step_new_reservation_search')),
                    {types: ['geocode']});

                // When the user selects an address from the dropdown, populate the address
                // fields in the form.
                autocomplete.addListener('place_changed', fillInAddress);
            }

            function fillInAddress() {
                // Get the place details from the autocomplete object.
                var place = autocomplete.getPlace();
                for (var component in componentForm) {
                    document.getElementById(component).value = '';
                    document.getElementById(component).disabled = false;
                }

                // Get each component of the address from the place details
                // and fill the corresponding field on the form.
                for (var i = 0; i < place.address_components.length; i++) {
                    var addressType = place.address_components[i].types[0];
                    if (componentForm[componentResolver[addressType]]) {
                        var val = place.address_components[i][componentForm[componentResolver[addressType]]];
                        document.getElementById(componentResolver[addressType]).value = val;

                    }
                }
            }

            // Bias the autocomplete object to the user's geographical location,
            // as supplied by the browser's 'navigator.geolocation' object.
            document.getElementById('add_step_new_reservation_search').onfocus = function geolocate() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        var geolocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        var circle = new google.maps.Circle({
                            center: geolocation,
                            radius: position.coords.accuracy
                        });
                        autocomplete.setBounds(circle.getBounds());
                    });
                }
            }

        </script>


        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBZp6Z4MQBZsENJAfEMP-Dd0X3TTl5IHQE&libraries=places&location=48.85661400000001,2.3522219000000177&radius=110000&strictbounds&callback=initAutocomplete" async="" defer=""></script>
    {% endblock %}
{% endblock %}


